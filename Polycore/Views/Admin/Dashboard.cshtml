@using Polycore.Models

@{
    ViewBag.Title = "Dashboard";
    var db = new ApplicationDbContext();
}
<div class="span12">
    <div class="template-wrapper">
        <div class="block block-page_header_block span12 first ">
            <div class="span12 block-title centered">
                <h2>Dashboard</h2>
                <p>You know what to do. Whatevs.</p>
            </div>
            <div class="span12 block-divider"></div>
        </div>
    </div>
    <div class="block block-column_block span6 first cf">
        <!-- Latest news -->
        <div class="block span12 first cf">
            <div class="title-wrapper">
                <h3 class="widget-title">
                    <i class="fa fa-user"></i>
                    Users
                </h3>
                <div class="clear"></div>
            </div>
            <div class="wcontainer">
                <strong>User Count: </strong> @(db.Users.Count())<br/>
                <strong>Admin Count: </strong> @(db.Users.Count(p => p.Roles.Count(b => b.RoleId == db.Roles.FirstOrDefault(c => c.Name == "Administrator").Id) == 1))<br />
                <strong>Editor Count: </strong> @(db.Users.Count(p => p.Roles.Count(b => b.RoleId == db.Roles.FirstOrDefault(c => c.Name == "Editor").Id) == 1))<br />
                <strong>Moderator Count: </strong> @(db.Users.Count(p => p.Roles.Count(b => b.RoleId == db.Roles.FirstOrDefault(c => c.Name == "Moderator").Id) == 1))<br />
                <strong>Member Count: </strong> @(db.Users.Count(p => p.Roles.Count(b => b.RoleId == db.Roles.FirstOrDefault(c => c.Name == "Member").Id) == 1))<br />
                @Html.ActionLink("Manage Users", "Users", "Admin", null, new Dictionary<string, object>() { { "class", "button-green button-small" } })
                <div class="clear"></div>
            </div>
        </div>
        <!-- End Latest News -->
    </div>

    <div class="block block-column_block span6 cf">
        <div class="block span12 cf">
            <div class="title-wrapper">
                <h3 class="widget-title">
                    <i class="fa fa-file-text"></i>
                    Posts
                </h3>
                <div class="clear"></div>
            </div>
            <div class="wcontainer">
                <strong>News Articles: </strong> @(db.NewsArticles.Count())<br />
                <strong>Newest Article: </strong> @(db.NewsArticles.OrderByDescending(p => p.Published).FirstOrDefault()?.Title)<br />
                <strong>Newest Article Comments: </strong> @(db.NewsArticles.OrderByDescending(p => p.Published).FirstOrDefault()?.Comments.Count())<br />
                @Html.ActionLink("Manage Posts", "Posts", "Admin", null, new Dictionary<string, object>() { { "class", "button-green button-small" } })
                <div class="clear"></div>
            </div>
        </div>
    </div>
</div>